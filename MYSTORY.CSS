/* =========================================================
   CONSEQUENCE â€” Premium Offline Theme (MYSTORY.CSS)
   - Modern, high-contrast dark theme (with light fallback)
   - Responsive grid, glass panels, tactile buttons
   - Strong focus states, reduced motion support
   - Matches the HTML shell IDs/classes exactly
   ========================================================= */

/* ------------------------------
   1) CSS Variables & Resets
   ------------------------------ */
:root {
  /* Core palette (dark) */
  --bg-0: #0b0c10;  /* page */
  --bg-1: #111318;  /* panels */
  --bg-2: #171a21;  /* cards */
  --ink:  #e6e8eb;  /* body text */
  --muted: #aeb4bd; /* secondary text */
  --brand: #ff6b35; /* accent */
  --brand-2: #ff944a; /* lighter accent */
  --good: #46da7e;
  --warn: #ffb020;
  --bad:  #ff4d4d;
  --link: #6ab0ff;
  --border: rgba(255,255,255,0.08);
  --shadow: 0 10px 30px rgba(0,0,0,0.45);
  --radius-lg: 14px;
  --radius-md: 10px;
  --radius-sm: 8px;

  /* Typography */
  --font-sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Noto Sans", "Liberation Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji";
  --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;

  /* Spacing scale */
  --space-1: 4px;  --space-2: 8px;  --space-3: 12px;  --space-4: 16px;  --space-5: 20px;  --space-6: 24px;  --space-7: 28px;  --space-8: 32px;  --space-10: 40px;

  /* Effects */
  --glass: linear-gradient(180deg, rgba(255,255,255,0.06), rgba(255,255,255,0.03));
  --ring: 0 0 0 3px rgba(255,107,53,0.35);
}

@media (prefers-color-scheme: light) {
  :root {
    --bg-0: #f6f7fb;
    --bg-1: #ffffff;
    --bg-2: #f1f3f8;
    --ink:  #0f141d;
    --muted: #566070;
    --border: rgba(20,23,28,0.08);
    --shadow: 0 8px 24px rgba(0,0,0,0.08);
  }
}

/* Reset */
*, *::before, *::after { box-sizing: border-box; }
html, body { height: 100%; }
html { scroll-behavior: smooth; }
body {
  margin: 0;
  font-family: var(--font-sans);
  color: var(--ink);
  background: radial-gradient(1200px 600px at 10% -10%, rgba(255,107,53,0.18), transparent 60%),
              radial-gradient(1000px 500px at 120% 10%, rgba(106,176,255,0.15), transparent 60%),
              linear-gradient(135deg, var(--bg-0) 0%, var(--bg-2) 100%);
  line-height: 1.6;
}

img, svg, video { max-width: 100%; display: block; }
.hidden { display: none !important; }

/* Focus */
:focus-visible { outline: 2px solid var(--brand); outline-offset: 2px; }

/* ------------------------------
   2) Layout & Header
   ------------------------------ */
#game-container {
  max-width: 1200px;
  margin: 0 auto;
  padding: var(--space-6);
}

.game-header {
  text-align: center;
  margin: var(--space-4) 0 var(--space-6);
  padding-bottom: var(--space-4);
  border-bottom: 1px solid var(--border);
}
.game-header h1 {
  margin: 0;
  font-size: clamp(1.8rem, 3.2vw, 2.8rem);
  letter-spacing: 0.4px;
  font-weight: 800;
  color: var(--ink);
  text-shadow: 0 2px 18px rgba(255,107,53,0.25);
}
.game-subtitle {
  margin-top: var(--space-2);
  color: var(--muted);
  font-style: italic;
}

/* Skip link */
.skip-link {
  position: absolute; left: -9999px; top: auto; width: 1px; height: 1px; overflow: hidden;
}
.skip-link:focus { position: static; width: auto; height: auto; padding: 6px 10px; background: var(--brand); color: #000; border-radius: 6px; }

/* ------------------------------
   3) Status Bar
   ------------------------------ */
.status-bar {
  display: flex; gap: var(--space-3); align-items: center; justify-content: space-between;
  background: var(--glass);
  border: 1px solid var(--border);
  border-radius: var(--radius-md);
  padding: var(--space-3) var(--space-4);
  box-shadow: var(--shadow);
  backdrop-filter: blur(8px);
  margin-bottom: var(--space-5);
}
.stats-group { display: flex; flex-wrap: wrap; gap: var(--space-2); }
.stat-pill {
  display: inline-flex; align-items: center; gap: 8px;
  padding: 6px 12px; border-radius: 999px;
  background: rgba(255,255,255,0.06);
  border: 1px solid var(--border);
  font-weight: 600; font-size: 0.9rem;
}
.stat-pill[title]:hover::after { content: attr(title); position: absolute; transform: translateY(-140%);
  padding: 4px 8px; background: #000; color: #fff; border-radius: 6px; font-size: 12px; white-space: nowrap; }

.status-pill { padding: 6px 12px; border-radius: 999px; border: 1px solid var(--border); font-weight: 600; }
.timer-neutral { color: var(--muted); background: rgba(255,255,255,0.06); }

/* Emphasis colors */
.strength { color: #ff7b7b; }
.agility { color: #7bff9a; }
.willpower { color: #7ba4ff; }
.charisma { color: #ff88ff; }

/* ------------------------------
   4) Game Interface Grid
   ------------------------------ */
.game-interface { background: transparent; }
.game-content {
  display: grid;
  grid-template-columns: 1.1fr 0.9fr;
  gap: var(--space-5);
}

/* Story column */
.story-section { display: grid; gap: var(--space-4); }
.story-display {
  min-height: 220px;
  padding: var(--space-5);
  border-radius: var(--radius-lg);
  background: var(--glass);
  border: 1px solid var(--border);
  box-shadow: var(--shadow);
  position: relative;
}
.story-display::before { content: ""; position: absolute; left: 0; right: 0; top: 0; height: 2px;
  background: linear-gradient(90deg, transparent, var(--brand), transparent); opacity: 0.35; }

.choices-display { display: grid; gap: var(--space-3); }
.choice {
  display: inline-flex; align-items: center; justify-content: space-between; gap: 10px;
  padding: 14px 16px; border-radius: var(--radius-md);
  background: linear-gradient(180deg, rgba(255,255,255,0.06), rgba(255,255,255,0.04));
  border: 1px solid var(--border);
  font-weight: 650; letter-spacing: .2px;
  transition: transform .12s ease, background .12s ease, border-color .12s ease, box-shadow .12s ease;
  cursor: pointer;
}
.choice:hover { transform: translateY(-1px); border-color: rgba(255,255,255,0.18); box-shadow: 0 8px 18px rgba(0,0,0,.25); }
.choice:active { transform: translateY(0); }
.choice:focus-visible { box-shadow: var(--ring); }
.choice.disabled, .choice[disabled] { opacity: .5; cursor: not-allowed; filter: grayscale(0.3); }

/* Optional contextual stripes */
.choice[data-type="moral"] { border-left: 4px solid var(--warn); }
.choice[data-type="combat"] { border-left: 4px solid var(--bad); }
.choice[data-type="social"] { border-left: 4px solid var(--good); }
.choice[data-type="stealth"]{ border-left: 4px solid var(--link); }

/* ------------------------------
   5) Info Panels (right column)
   ------------------------------ */
.info-panels { display: grid; gap: var(--space-4); grid-template-columns: 1fr 1fr; }
.info-panel {
  border-radius: var(--radius-lg);
  background: var(--glass);
  border: 1px solid var(--border);
  box-shadow: var(--shadow);
  overflow: hidden;
  display: flex; flex-direction: column;
}
.panel-header {
  display: flex; align-items: center; justify-content: space-between;
  padding: 10px 14px; background: linear-gradient(180deg, rgba(255,255,255,0.08), rgba(255,255,255,0.03));
  border-bottom: 1px solid var(--border);
}
.panel-header h3 { margin: 0; font-size: .95rem; letter-spacing: .3px; color: var(--brand); text-transform: uppercase; }
.panel-time, .relationship-count { color: var(--muted); font-size: .8rem; }

.panel-content { padding: 14px; font-size: .95rem; color: var(--ink); }

/* Character specifics */
.character-name { font-weight: 800; font-size: 1.05rem; color: var(--brand); }
.character-background { color: var(--muted); font-style: italic; margin-bottom: var(--space-2); }

.inventory-list { display: flex; flex-wrap: wrap; gap: 8px; margin-top: 8px; }
.inventory-chip { padding: 6px 10px; border: 1px solid var(--border); border-radius: 999px; background: rgba(255,255,255,0.05); font-size: .85rem; cursor: pointer; }
.inventory-chip:hover { border-color: rgba(255,255,255,0.2); }
.empty-inventory { color: var(--muted); font-style: italic; }

.trauma-bar-container { width: 100%; height: 8px; background: rgba(255,255,255,0.08); border-radius: 999px; overflow: hidden; margin-top: 6px; }
.trauma-bar { height: 100%; background: linear-gradient(90deg, var(--good) 0%, var(--warn) 50%, var(--bad) 100%); width: 0%; transition: width .45s ease; }
.trauma-warning { margin-top: 6px; padding: 6px 8px; border-radius: 8px; font-size: .85rem; border: 1px solid var(--border); }
.trauma-warning.moderate { color: var(--brand); background: rgba(255,107,53,0.08); }
.trauma-warning.high { color: var(--warn); background: rgba(255,176,32,0.1); }
.trauma-warning.critical { color: var(--bad); background: rgba(255,77,77,0.1); }

.persona-grid { display: grid; gap: 6px; }
.persona-point { display: flex; justify-content: space-between; font-size: .9rem; }
.persona-name { color: var(--muted); }
.persona-value { font-weight: 700; color: var(--brand-2); }

/* Journal */
.journal-item { padding: 8px 0; border-bottom: 1px solid var(--border); }
.journal-title { font-weight: 700; color: var(--brand); }
.journal-objective { color: var(--muted); font-size: .9rem; }

/* Event Log */
.event-log { font-size: .9rem; line-height: 1.4; }
.event-log-entry { padding: 6px 0; border-bottom: 1px solid var(--border); transition: background .15s ease, padding .15s ease; }
.event-log-entry:hover { background: rgba(255,255,255,0.03); padding-left: 8px; }
.event-log-entry.world_event { color: var(--brand); font-weight: 600; }
.event-log-entry.consequence { color: var(--warn); font-style: italic; }
.event-log-entry.trauma { color: var(--bad); }
.event-log-entry.discovery { color: var(--good); }

/* Relationships */
.relationships-list { display: grid; gap: 8px; }
.relationship-item { display: flex; justify-content: space-between; align-items: center; padding: 6px 0; border-bottom: 1px solid var(--border); }
.relationship-name { font-weight: 600; }
.relationship-status { min-width: 36px; text-align: center; font-weight: 700; font-size: .85rem; padding: 2px 8px; border-radius: 999px; border: 1px solid var(--border); }
.relationship-trust-neutral { color: var(--muted); background: rgba(255,255,255,0.05); }
.relationship-trust-positive { color: var(--good); background: rgba(70,218,126,0.12); }
.relationship-trust-negative { color: var(--bad); background: rgba(255,77,77,0.12); }

/* Backend / Debug */
.backend-content { font-family: var(--mono); font-size: .85rem; }
.backend-section { margin-bottom: 12px; padding: 10px; background: rgba(255,255,255,0.04); border-left: 3px solid var(--brand); border-radius: 8px; }
.flag-display { display: grid; grid-template-columns: repeat(auto-fit,minmax(140px,1fr)); gap: 8px; }
.flag-item { background: rgba(255,107,53,0.1); border: 1px solid rgba(255,107,53,0.3); padding: 6px 8px; border-radius: 8px; color: #ffb899; }
.decision-tree { max-height: 220px; overflow: auto; border: 1px dashed var(--border); border-radius: 8px; padding: 8px; }
.decision-node { background: rgba(255,255,255,0.05); border-left: 3px solid var(--good); padding: 6px 8px; margin: 4px 0; border-radius: 6px; }
.decision-node.current { border-left-color: var(--brand); background: rgba(255,107,53,0.1); }

/* ------------------------------
   6) Controls & Buttons
   ------------------------------ */
.game-controls { display: flex; flex-wrap: wrap; gap: var(--space-3); justify-content: center; padding: var(--space-5) 0; }
.primary-button, .secondary-button, .control-button, .mini-button {
  appearance: none; border: none; cursor: pointer; font: inherit;
}
.primary-button {
  background: linear-gradient(180deg, var(--brand), #e55f2f);
  color: #000; font-weight: 800; letter-spacing: .2px;
  padding: 12px 20px; border-radius: var(--radius-md);
  box-shadow: 0 8px 18px rgba(255,107,53,0.25);
  transition: transform .12s ease, filter .12s ease, box-shadow .12s ease;
}
.primary-button:hover { transform: translateY(-1px); filter: saturate(1.05); }
.primary-button:active { transform: translateY(0); }
.primary-button:focus-visible { box-shadow: var(--ring); }

.secondary-button {
  background: linear-gradient(180deg, rgba(255,255,255,0.08), rgba(255,255,255,0.06));
  color: var(--ink);
  padding: 12px 20px; border-radius: var(--radius-md);
  border: 1px solid var(--border);
}
.secondary-button:hover { border-color: rgba(255,255,255,0.18); }
.secondary-button:focus-visible { box-shadow: var(--ring); }

.control-button {
  background: linear-gradient(180deg, rgba(106,176,255,0.15), rgba(106,176,255,0.08));
  color: var(--link);
  padding: 12px 18px; border-radius: var(--radius-md);
  border: 1px solid rgba(106,176,255,0.3);
}
.control-button:hover { box-shadow: 0 8px 18px rgba(106,176,255,0.18); }
.control-button:focus-visible { box-shadow: var(--ring); }

.mini-button { background: rgba(255,255,255,0.08); color: var(--muted); padding: 6px 10px; border-radius: 8px; border: 1px solid var(--border); }
.mini-button:hover { color: var(--ink); border-color: rgba(255,255,255,0.2); }

/* Export button variant */
#export-game { background: linear-gradient(180deg, rgba(68,68,255,0.18), rgba(68,68,255,0.08)); border: 1px solid rgba(68,68,255,0.35); color: #aab0ff; }
#export-game:hover { box-shadow: 0 8px 18px rgba(68,68,255,0.25); }

/* ------------------------------
   7) Consequence Popup
   ------------------------------ */
.consequence-popup { position: fixed; inset: 0; display: none; align-items: center; justify-content: center; background: rgba(0,0,0,0.75); z-index: 90; }
.consequence-popup:not(.hidden) { display: flex; }
.consequence-content { background: var(--glass); border: 2px solid var(--brand); border-radius: 16px; padding: 28px; box-shadow: var(--shadow); max-width: 520px; text-align: center; }
.consequence-content p { margin: 0; font-weight: 800; color: var(--brand); font-size: 1.2rem; }

/* ------------------------------
   8) Micro-interactions & Scrollbars
   ------------------------------ */
@keyframes fadeInUp { from { opacity: 0; transform: translateY(8px); } to { opacity: 1; transform: translateY(0); } }
.info-panel, .story-display, .choice { animation: fadeInUp .22s ease both; }

/********** Custom Scrollbar (WebKit) **********/
*::-webkit-scrollbar { height: 10px; width: 10px; }
*::-webkit-scrollbar-track { background: rgba(255,255,255,0.03); }
*::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.18); border-radius: 10px; }
*::-webkit-scrollbar-thumb:hover { background: rgba(255,255,255,0.28); }

/* ------------------------------
   9) Responsive
   ------------------------------ */
@media (max-width: 1080px) {
  .game-content { grid-template-columns: 1fr; }
  .info-panels { grid-template-columns: 1fr 1fr; }
}
@media (max-width: 720px) {
  #game-container { padding: var(--space-4); }
  .info-panels { grid-template-columns: 1fr; }
  .status-bar { position: sticky; top: 0; z-index: 5; backdrop-filter: blur(8px); }
  .game-controls { padding-top: var(--space-4); }
}

/* ------------------------------
   10) Reduced Motion
   ------------------------------ */
@media (prefers-reduced-motion: reduce) {
  * { animation-duration: .001ms !important; animation-iteration-count: 1 !important; transition: none !important; scroll-behavior: auto !important; }
}

/* ------------------------------
   11) Utility classes
   ------------------------------ */
.sr-only { position: absolute; width: 1px; height: 1px; padding: 0; margin: -1px; overflow: hidden; clip: rect(0,0,0,0); white-space: nowrap; border: 0; }
.center { display: grid; place-items: center; }
.soft-border { border: 1px solid var(--border); border-radius: var(--radius-md); }
.tint-brand { color: var(--brand); }

/* ------------------------------
   12) Print (optional)
   ------------------------------ */
@media print {
  body { background: #fff; color: #000; }
  .status-bar, .game-controls, #backend-panel { display: none !important; }
  .story-display, .info-panel { box-shadow: none; border: 1px solid #000; }
}
