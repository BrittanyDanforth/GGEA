<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="color-scheme" content="dark light" />
  <title>THE LONG SIREN — Offline Story Game</title>

  <!-- Optional: drop your CSS in this local file later -->
  <link rel="stylesheet" href="MYSTORY.CSS" />

  <!-- App metadata (purely local) -->
  <meta name="application-name" content="THE LONG SIREN" />
  <meta name="description" content="Offline story/choice engine for The Long Siren" />
</head>
<body>
  <!-- Accessibility helpers -->
  <a class="skip-link" href="#scene-text">Skip to story</a>
  <noscript>
    <div class="summary some-fail" role="alert" style="padding:1rem; margin:1rem; border:2px solid;">
      This game requires JavaScript to run offline.
    </div>
  </noscript>

  <!-- Header -->
  <header class="game-header" role="banner">
    <h1>THE LONG SIREN</h1>
    <p class="game-subtitle">Every siren marks a choice you can't undo.</p>
  </header>

  <!-- Main container -->
  <main id="game-container" role="application" aria-label="Game interface">

    <!-- Status / Stats bar (populated by engine) -->
    <div id="stats" class="status-bar" role="status" aria-live="polite">
      <!-- stat pills + timers injected here -->
    </div>

    <!-- Core layout: story on the left, info panels on the right -->
    <section class="game-interface">
      <div class="game-content">
        <!-- STORY COLUMN -->
        <section class="story-section" aria-label="Story and choices">
          <div id="scene-text" class="story-display" role="region" aria-live="polite" aria-atomic="true">
            <!-- current scene text injected here -->
          </div>
          <div id="choices" class="choices-display" role="group" aria-label="Available choices">
            <!-- choice buttons injected here -->
          </div>
        </section>

        <!-- INFO PANELS COLUMN -->
        <aside class="info-panels" aria-label="Character, journal, events, relationships">
          <!-- Character Panel -->
          <section id="character-panel" class="info-panel" aria-labelledby="character-h">
            <div class="panel-header">
              <h3 id="character-h">Character</h3>
              <div class="panel-time" id="dayhour-indicator">Day 0 · 00:00</div>
            </div>
            <div class="panel-content character-info">
              <div class="character-name" id="char-name">—</div>
              <div class="character-background" id="char-background">—</div>

              <div class="character-inventory">
                <strong>Inventory</strong>
                <div id="inventory-list" class="inventory-list" aria-live="polite">
                  <span class="empty-inventory">(empty)</span>
                </div>
              </div>

              <div class="character-trauma">
                <strong>Trauma / Stress</strong>
                <div class="trauma-bar-container" aria-hidden="true"><div class="trauma-bar" id="trauma-bar" style="width:0%"></div></div>
                <div class="trauma-warning moderate" id="trauma-warning">Stable</div>
              </div>

              <div class="persona-breakdown">
                <strong>Persona</strong>
                <div class="persona-grid" id="persona-grid">
                  <!-- persona rows injected here -->
                </div>
              </div>
            </div>
          </section>

          <!-- Journal / Objectives Panel -->
          <section id="journal-panel" class="info-panel" aria-labelledby="journal-h">
            <div class="panel-header">
              <h3 id="journal-h">Journal</h3>
              <div class="consequence-count" id="objective-count">0 objectives</div>
            </div>
            <div class="panel-content" id="journal-list">
              <!-- journal items injected here -->
            </div>
          </section>

          <!-- Event Log Panel -->
          <section id="events-panel" class="info-panel" aria-labelledby="events-h">
            <div class="panel-header">
              <h3 id="events-h">Event Log</h3>
              <div class="panel-time" id="world-time">T+0h</div>
            </div>
            <div class="panel-content event-log" id="event-log" aria-live="polite">
              <!-- events injected here -->
            </div>
          </section>

          <!-- Relationships Panel -->
          <section id="relationships-panel" class="info-panel" aria-labelledby="relations-h">
            <div class="panel-header">
              <h3 id="relations-h">Relationships</h3>
              <div class="relationship-count" id="relationship-count">0 contacts</div>
            </div>
            <div class="panel-content relationships-list" id="relationships-list">
              <!-- relationship rows injected here -->
            </div>
          </section>

          <!-- Backend / Debug Panel (optional) -->
          <section id="backend-panel" class="info-panel" aria-labelledby="backend-h">
            <div class="panel-header">
              <h3 id="backend-h">Backend</h3>
              <button class="mini-button" id="toggle-backend" type="button" aria-expanded="true">Toggle</button>
            </div>
            <div class="panel-content backend-content" id="backend-content">
              <div class="backend-section">
                <h4>Flags</h4>
                <div class="flag-display" id="flag-display"></div>
              </div>
              <div class="backend-section">
                <h4>Decision Trace</h4>
                <div class="decision-tree" id="decision-tree"></div>
              </div>
              <div class="backend-section">
                <h4>State Hash</h4>
                <div class="state-hash" id="state-hash">—</div>
              </div>
            </div>
          </section>
        </aside>
      </div>

      <!-- Controls -->
      <div class="game-controls" aria-label="Game controls">
        <button id="new-game" class="primary-button" type="button">New Game</button>
        <button id="continue-game" class="secondary-button" type="button">Continue</button>
        <button id="save-game" class="control-button" type="button">Save</button>
        <button id="load-game" class="control-button" type="button">Load</button>
        <button id="export-game" class="control-button" type="button">Export</button>
        <label for="file-loader" class="sr-only">Load a saved game</label>
        <input id="file-loader" type="file" accept=".json" hidden />
      </div>
    </section>
  </main>

  <!-- Consequence / Telltale-style popup -->
  <div id="consequence-popup" class="consequence-popup hidden" role="dialog" aria-modal="true" aria-labelledby="consequence-text">
    <div class="consequence-content">
      <p id="consequence-text">This will be remembered.</p>
      <div style="margin-top:1rem;">
        <button id="consequence-ok" class="primary-button" type="button">OK</button>
      </div>
    </div>
  </div>

  <!-- Templates (optional, used by engine if desired) -->
  <template id="tpl-choice">
    <button class="choice" type="button"><span class="choice-text"></span></button>
  </template>
  <template id="tpl-journal-item">
    <div class="journal-item">
      <div class="journal-title"></div>
      <div class="journal-objective"></div>
    </div>
  </template>
  <template id="tpl-relationship-item">
    <div class="relationship-item">
      <span class="relationship-name"></span>
      <span class="relationship-status relationship-trust-neutral">0</span>
    </div>
  </template>

  <!-- Minimal bootstrapping: keep everything offline -->
  <script>
    // Optional: placeholder story so the shell shows something before your engine loads
    window.STORY_DATABASE = window.STORY_DATABASE || {
      intro: {
        text: "Welcome to THE LONG SIREN (offline shell). Add your engine + full story to play.",
        choices: [ { text: "Begin", goTo: "intro" } ]
      }
    };
  </script>
  
  <!-- Your single local bundle with engine + story goes here. No CDNs, no fetch. -->
  <script src="MYSTORY.js"></script>

</body>
</html>
